(()=>{"use strict";var t={10:t=>{t.exports=JSON.parse('{"compressionlevel":-1,"editorsettings":{"export":{"format":"json","target":"dnd.json"}},"height":32,"infinite":false,"layers":[{"data":[1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,1,2,3,4,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,1,2,3,4,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,1,2,3,4,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,2,3,4,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,2,3,4,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,1,2,3,4,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,1,2,3,4,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,1,1,2,3,4,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,1,2,3,4,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,1,2,3,4,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,1,2,3,4,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,1,2,3,4,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,4,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,1,2,3,4,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,1,2,3,4,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4],"height":32,"id":1,"name":"ground","opacity":1,"type":"tilelayer","visible":true,"width":32,"x":0,"y":0},{"data":[1,33,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,97,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,33,49,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"height":32,"id":3,"name":"walls","opacity":1,"type":"tilelayer","visible":true,"width":32,"x":0,"y":0},{"data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,865,882,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,881,898,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,897,914,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,913,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,578,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,577,0,594,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,578,593,0,610,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,577,0,594,609,0,626,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,578,0,593,0,610,625,0,642,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,577,0,594,0,609,0,626,641,0,658,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,593,0,610,0,625,0,642,657,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,609,0,626,0,641,0,658,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,625,0,642,0,657,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,641,0,658,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,657,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"height":32,"id":7,"name":"decor","opacity":1,"type":"tilelayer","visible":true,"width":32,"x":0,"y":0}],"nextlayerid":8,"nextobjectid":1,"orientation":"isometric","renderorder":"left-up","tiledversion":"1.4.3","tileheight":32,"tilesets":[{"firstgid":1,"source":"dnd.tsx"},{"firstgid":673,"source":"grassland_structures.tsx"}],"tilewidth":64,"type":"map","version":1.4,"width":32}')}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}(()=>{const t=function(){function t(t,e,n){this.id=t,this.height=e,this.width=n}return t.prototype.init=function(){var t=document.querySelector("body"),e=document.createElement("canvas");e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),e.setAttribute("id",this.id),t.appendChild(e),this._ctx=e.getContext("2d")},Object.defineProperty(t.prototype,"canvasData",{get:function(){return{context:this._ctx,width:this.width,height:this.height}},enumerable:!1,configurable:!0}),t}();var e,r,i,o,a,s=function(){function t(t,e){this.isRender=!1,this._cameraMatrix=[],this.x0=0,this.y0=0,this._layers=e}return t.prototype.getLayer=function(t){for(var e=Array.from({length:16},(function(t,e){return Array.from({length:16})})),n=0;n<16;n++)for(var r=0;r<16;r++)e[n][r]=t.layerMatrix[n+this.y0][r+this.x0];return e},t.prototype.fillMatrix=function(){for(var t in this._cameraMatrix=[],this._layers){var e=this._layers[t];this._cameraMatrix.push(this.getLayer(e))}},Object.defineProperty(t.prototype,"getCamera",{get:function(){return this.fillMatrix(),this._cameraMatrix},enumerable:!1,configurable:!0}),t.prototype.setAsRender=function(){this.isRender=!0},t.prototype.moveUp=function(){0!==this.y0&&(this.y0-=1,this.isRender=!1)},t.prototype.moveDown=function(){16!==this.y0&&(this.y0+=1,this.isRender=!1)},t.prototype.moveLeft=function(){0!==this.x0&&(this.x0-=1,this.isRender=!1)},t.prototype.moveRight=function(){16!==this.x0&&(this.x0+=1,this.isRender=!1)},t}(),u=function(){function t(){}return t.renderLayer=function(t,e){for(var n in t)for(var r in t[n]){var i=t[n][r];if(i.tile){var o=64*Number(r)/2,a=32*Number(n),s=o-a+e.width/2-32,u=(o+a)/2+e.height/8;e.context.drawImage(i.tile,s,u,64,32)}}},t.render=function(t,e){if(!t.isRender){e.context.clearRect(0,0,e.width,e.height),e.context.fillStyle="#000",e.context.fillRect(0,0,e.width,e.height);for(var n=0,r=t.getCamera;n<r.length;n++){var i=r[n];this.renderLayer(i,e)}t.setAsRender()}},t}(),c=function(){function t(){}return t.init=function(t,e){var n=this;requestAnimationFrame((function(){u.render(t,e),requestAnimationFrame((function(){return n.init(t,e)}))}))},t}(),l=function(){function t(){}return t.prototype.setControllerPosition=function(t,e,n){switch(t.key){case"ArrowDown":n.moveDown();break;case"ArrowUp":n.moveUp();break;case"ArrowLeft":n.moveLeft();break;case"ArrowRight":n.moveRight()}},t}(),f=function(){function t(t){this.layerData=t,this.layerMatrix=[]}return t.prototype.getTileRow=function(t,e){for(var n=[],r=t;r<e;r++)n.push(this.layerData.data[r]);return n},t.prototype.generateTile=function(t,e){var n=e,r=64*(n-1),i=0,o=t.sprites.find((function(t){return n>=t.firstTile&&n<=t.lastTile})),a=document.createElement("canvas");a.setAttribute("width",String(64)),a.setAttribute("height",String(32));var s=a.getContext("2d");if(!o)return!1;1!=o.firstTile&&(n-=o.firstTile),!n&&(n=1),console.log(n);var u=o.asset,c=u.naturalWidth/64,l=u.naturalHeight/32,f=0;if(n>c){for(var h=0;h<l;h++)n>h*c&&n<=h*c+c&&(f=h);r=n-c*f-1,i=32*f}return s.drawImage(u,r,i,64,32,0,0,64,32),a},t.prototype.fillLayerMatrix=function(t){for(var e=this.layerData.data.length/32,n=[],r=0;r<e;r++)n.push(this.getTileRow(32*r,32*(r+1)));for(r=0;r<n.length;r++)for(var i=0;i<n[r].length;i++){var o={tile:this.generateTile(t,n[r][i])};n[r][i]=o}this.layerMatrix=n},t}(),h=function(){function t(){}return t.load=function(t){return e=this,n=void 0,i=function(){return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){return t.asset.src=t.src,[2,new Promise((function(e){t.src||e(),t.asset.addEventListener("load",(function(){e()}))}))]}))},new((r=void 0)||(r=Promise))((function(t,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(a,s)}u((i=i.apply(e,n||[])).next())}));var e,n,r,i},t}(),p=(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,n)},function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.loadAll=function(t){return e=this,n=void 0,i=function(){var e,n,r,i;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(o){for(e=[],n=0,r=t;n<r.length;n++)i=r[n],e.push(this.load(i));return[2,Promise.all(e)]}))},new((r=void 0)||(r=Promise))((function(t,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(a,s)}u((i=i.apply(e,n||[])).next())}));var e,n,r,i},e}(h),d=function(){function t(t){this.assetsData=t,this.sprites=[]}return t.prototype.loadAssets=function(){return t=this,e=void 0,r=function(){var t=this;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){switch(e.label){case 0:return this.assetsData.map((function(e){var n={id:e.source.split(".")[0],firstTile:e.firstgid,lastTile:0,asset:new Image,src:"./public/assets/"+e.source.split(".")[0]+".png"};t.sprites.push(n)})),this.sprites.map((function(e,n){t.sprites[n+1]?e.lastTile=t.sprites[n+1].firstTile-1:e.lastTile=1e6})),[4,y.loadAll(this.sprites)];case 1:return e.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}));var t,e,n,r},t}(),v=new t("canvas",768,1024),b=n(10);r=void 0,i=void 0,a=function(){var t,e,n,r,i,o,a,u,h;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(p){switch(p.label){case 0:return v.init(),t=v.canvasData,[4,(e=new d(b.tilesets)).loadAssets()];case 1:for(p.sent(),n=[],r=0,i=b.layers;r<i.length;r++)o=i[r],(a=new f(o)).fillLayerMatrix(e),n.push(a);return u=new s(t,n),c.init(u,t),h=new l,document.getElementById("canvas"),window.addEventListener("keydown",(function(e){return h.setControllerPosition(e,t,u)})),[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function n(t){try{u(a.next(t))}catch(t){e(t)}}function s(t){try{u(a.throw(t))}catch(t){e(t)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof o?r:new o((function(t){t(r)}))).then(n,s)}u((a=a.apply(r,i||[])).next())}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9GYWxsb3V0RG5EL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0ZhbGxvdXREbkQvLi9zcmMvYXBwL2dlbmVyYWwvR2FtZS50cyIsIndlYnBhY2s6Ly9GYWxsb3V0RG5ELy4vc3JjL2FwcC9nZW5lcmFsL0NhbWVyYS50cyIsIndlYnBhY2s6Ly9GYWxsb3V0RG5ELy4vc3JjL2FwcC9nZW5lcmFsL1JlbmRlci50cyIsIndlYnBhY2s6Ly9GYWxsb3V0RG5ELy4vc3JjL2FwcC9nZW5lcmFsL0dhbWVMb29wLnRzIiwid2VicGFjazovL0ZhbGxvdXREbkQvLi9zcmMvYXBwL0NvbnRyb2xsZXJzL0tleWJvYXJkQ29udHJvbGxlci50cyIsIndlYnBhY2s6Ly9GYWxsb3V0RG5ELy4vc3JjL2FwcC9nZW5lcmFsL0xheWVyLnRzIiwid2VicGFjazovL0ZhbGxvdXREbkQvLi9zcmMvYXBwL0xvYWRlcnMvTG9hZGVyLnRzIiwid2VicGFjazovL0ZhbGxvdXREbkQvLi9zcmMvYXBwL0xvYWRlcnMvSW1hZ2VMb2FkZXIudHMiLCJ3ZWJwYWNrOi8vRmFsbG91dERuRC8uL3NyYy9hcHAvZ2VuZXJhbC9Bc3NldHMudHMiLCJ3ZWJwYWNrOi8vRmFsbG91dERuRC8uL3NyYy9hcHAvaW5kZXgudHMiXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJpZCIsImhlaWdodCIsIndpZHRoIiwidGhpcyIsImluaXQiLCJib2R5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsIlN0cmluZyIsImFwcGVuZENoaWxkIiwiX2N0eCIsImdldENvbnRleHQiLCJjb250ZXh0IiwiZGF0YSIsImxheWVycyIsImlzUmVuZGVyIiwiX2NhbWVyYU1hdHJpeCIsIngwIiwieTAiLCJfbGF5ZXJzIiwiZ2V0TGF5ZXIiLCJsZXZlbExheWVyIiwiY2FtZXJhTGF5ZXIiLCJBcnJheSIsImZyb20iLCJsZW5ndGgiLCJfIiwiaSIsInkiLCJ4IiwibGF5ZXJNYXRyaXgiLCJmaWxsTWF0cml4IiwibGF5ZXJJbmRleCIsImxheWVyIiwicHVzaCIsInNldEFzUmVuZGVyIiwibW92ZVVwIiwibW92ZURvd24iLCJtb3ZlTGVmdCIsIm1vdmVSaWdodCIsInJlbmRlckxheWVyIiwiY2FudmFzRGF0YSIsImoiLCJ0aWxlIiwiY2FydFgiLCJOdW1iZXIiLCJjYXJ0WSIsImlzb1giLCJpc29ZIiwiZHJhd0ltYWdlIiwicmVuZGVyIiwiY2FtZXJhIiwiY2xlYXJSZWN0IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJnZXRDYW1lcmEiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJSZW5kZXIiLCJzZXRDb250cm9sbGVyUG9zaXRpb24iLCJlIiwia2V5IiwibGF5ZXJEYXRhIiwiZ2V0VGlsZVJvdyIsImZpcnN0SW5kZXgiLCJsYXN0SW5kZXgiLCJyb3ciLCJnZW5lcmF0ZVRpbGUiLCJhc3NldHMiLCJ0aWxlSWQiLCJzWCIsInNZIiwic3ByaXRlIiwic3ByaXRlcyIsImZpbmQiLCJzIiwiZmlyc3RUaWxlIiwibGFzdFRpbGUiLCJjdHgiLCJjb25zb2xlIiwibG9nIiwiYXNzZXQiLCJtYXhJblJvdyIsIm1heFJvdyIsImN1cnJlbnRUaWxlSWRSb3ciLCJmaWxsTGF5ZXJNYXRyaXgiLCJxdWFudGl0eVJvd3MiLCJsYXllck1hdHJpeFRpbGVJZCIsImxvYWQiLCJzcmMiLCJQcm9taXNlIiwicmVzb2x2ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJsb2FkQWxsIiwiaW1hZ2VzIiwiYWxsTG9hZGVycyIsImltYWdlIiwiYWxsIiwiTG9hZGVyIiwiYXNzZXRzRGF0YSIsImxvYWRBc3NldHMiLCJtYXAiLCJhIiwic291cmNlIiwic3BsaXQiLCJmaXJzdGdpZCIsIkltYWdlIiwiSW1hZ2VMb2FkZXIiLCJnYW1lIiwibGF5ZXJzRGF0YSIsIkFzc2V0cyIsInRpbGVzZXRzIiwiTGF5ZXIiLCJDYW1lcmEiLCJHYW1lTG9vcCIsImNvbnRyb2xsZXIiLCJLZXlib2FyZENvbnRyb2xsZXIiLCJnZXRFbGVtZW50QnlJZCIsIndpbmRvdyJdLCJtYXBwaW5ncyI6IjI5TkFDSUEsRUFBMkIsR0FHL0IsU0FBU0MsRUFBb0JDLEdBRTVCLEdBQUdGLEVBQXlCRSxHQUMzQixPQUFPRixFQUF5QkUsR0FBVUMsUUFHM0MsSUFBSUMsRUFBU0osRUFBeUJFLEdBQVksQ0FHakRDLFFBQVMsSUFPVixPQUhBRSxFQUFvQkgsR0FBVUUsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0NHLEVBQU9ELFEsY0NsQmYsV0FNRSxXQUFZRyxFQUFZQyxFQUFnQkMsR0FDdENDLEtBQUtILEdBQUtBLEVBQ1ZHLEtBQUtGLE9BQVNBLEVBQ2RFLEtBQUtELE1BQVFBLEVBdUJqQixPQXBCUyxZQUFBRSxLQUFQLFdBQ0UsSUFBTUMsRUFBT0MsU0FBU0MsY0FBYyxRQUM5QkMsRUFBU0YsU0FBU0csY0FBYyxVQUV0Q0QsRUFBT0UsYUFBYSxRQUFTQyxPQUFPUixLQUFLRCxRQUN6Q00sRUFBT0UsYUFBYSxTQUFVQyxPQUFPUixLQUFLRixTQUMxQ08sRUFBT0UsYUFBYSxLQUFNUCxLQUFLSCxJQUUvQkssRUFBS08sWUFBWUosR0FDakJMLEtBQUtVLEtBQU9MLEVBQU9NLFdBQVcsT0FHaEMsc0JBQUkseUJBQVUsQyxJQUFkLFdBTUUsTUFMMEIsQ0FDeEJDLFFBQVNaLEtBQUtVLEtBQ2RYLE1BQU9DLEtBQUtELE1BQ1pELE9BQVFFLEtBQUtGLFMsZ0NBSW5CLEVBaENBLEdDR0EsSSxVQUFBLGFBZUUsV0FBWWUsRUFBbUJDLEdBUC9CLEtBQUFDLFVBQXFCLEVBSWIsS0FBQUMsY0FBdUIsR0FJN0JoQixLQUFLaUIsR0FBSyxFQUNWakIsS0FBS2tCLEdBQUssRUFDVmxCLEtBQUttQixRQUFVTCxFQStEbkIsT0E1RFUsWUFBQU0sU0FBUixTQUFpQkMsR0FHZixJQUZB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LyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImltcG9ydCB7SUNhbnZhc0RhdGF9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0lBc3NldHNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWUge1xyXG4gIHByaXZhdGUgX2N0eDogYW55O1xyXG4gIHB1YmxpYyBoZWlnaHQ6IG51bWJlcjtcclxuICBwdWJsaWMgd2lkdGg6IG51bWJlcjtcclxuICBwdWJsaWMgaWQ6IHN0cmluZztcclxuXHJcbiAgY29uc3RydWN0b3IoaWQ6IHN0cmluZywgaGVpZ2h0OiBudW1iZXIsIHdpZHRoOiBudW1iZXIpIHtcclxuICAgIHRoaXMuaWQgPSBpZDtcclxuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGluaXQoKSB7XHJcbiAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xyXG4gICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcblxyXG4gICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBTdHJpbmcodGhpcy53aWR0aCkpO1xyXG4gICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgU3RyaW5nKHRoaXMuaGVpZ2h0KSk7XHJcbiAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdpZCcsIHRoaXMuaWQpO1xyXG5cclxuICAgIGJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuICAgIHRoaXMuX2N0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNhbnZhc0RhdGEoKSB7XHJcbiAgICBjb25zdCBkYXRhOiBJQ2FudmFzRGF0YSA9IHtcclxuICAgICAgY29udGV4dDogdGhpcy5fY3R4LFxyXG4gICAgICB3aWR0aDogdGhpcy53aWR0aCxcclxuICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7SUNhbnZhc0RhdGF9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0lBc3NldHNcIjtcclxuaW1wb3J0IHtJQ2FtZXJhfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQ2FtZXJhXCI7XHJcbmltcG9ydCB7Q29uc3RhbnRzfSBmcm9tIFwiLi4vZW51bXMvY29uc3RhbnRzXCI7XHJcbmltcG9ydCB7SUxheWVyfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JTGF5ZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDYW1lcmEgaW1wbGVtZW50cyBJQ2FtZXJhIHtcclxuXHJcbiAgeDA6IG51bWJlcjtcclxuICB4RW5kOiBudW1iZXI7XHJcblxyXG4gIHkwOiBudW1iZXI7XHJcbiAgeUVuZDogbnVtYmVyO1xyXG5cclxuICBpc1JlbmRlcjogYm9vbGVhbiA9ICBmYWxzZTtcclxuXHJcbiAgcmVhZG9ubHkgX2xheWVyczogSUxheWVyW107XHJcblxyXG4gIHByaXZhdGUgX2NhbWVyYU1hdHJpeDogYW55W10gPSBbXTtcclxuXHJcblxyXG4gIGNvbnN0cnVjdG9yKGRhdGE6IElDYW52YXNEYXRhLCBsYXllcnM6IElMYXllcltdKSB7XHJcbiAgICB0aGlzLngwID0gMDtcclxuICAgIHRoaXMueTAgPSAwO1xyXG4gICAgdGhpcy5fbGF5ZXJzID0gbGF5ZXJzO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRMYXllcihsZXZlbExheWVyOiBJTGF5ZXIpIHtcclxuICAgIGNvbnN0IGNhbWVyYUxheWVyID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiBDb25zdGFudHMuY2FtZXJhU2l6ZX0sXHJcbiAgICAgIChfLCBpKSA9PiBBcnJheS5mcm9tKHtsZW5ndGggOiBDb25zdGFudHMuY2FtZXJhU2l6ZX0pKTtcclxuICAgIGZvciAobGV0IHkgPSAwOyB5IDwgQ29uc3RhbnRzLmNhbWVyYVNpemU7IHkrKykge1xyXG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IENvbnN0YW50cy5jYW1lcmFTaXplOyB4KyspIHtcclxuICAgICAgICBjYW1lcmFMYXllclt5XVt4XSA9IGxldmVsTGF5ZXIubGF5ZXJNYXRyaXhbeSArIHRoaXMueTBdW3ggKyB0aGlzLngwXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNhbWVyYUxheWVyO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBmaWxsTWF0cml4KCkge1xyXG4gICAgdGhpcy5fY2FtZXJhTWF0cml4ID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGxheWVySW5kZXggaW4gdGhpcy5fbGF5ZXJzKSB7XHJcbiAgICAgIGNvbnN0IGxheWVyID0gdGhpcy5fbGF5ZXJzW2xheWVySW5kZXhdO1xyXG4gICAgICB0aGlzLl9jYW1lcmFNYXRyaXgucHVzaCh0aGlzLmdldExheWVyKGxheWVyKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXQgZ2V0Q2FtZXJhKCkge1xyXG4gICAgdGhpcy5maWxsTWF0cml4KCk7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FtZXJhTWF0cml4O1xyXG4gIH1cclxuXHJcbiAgc2V0QXNSZW5kZXIoKSB7XHJcbiAgICB0aGlzLmlzUmVuZGVyID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIG1vdmVVcCgpIHtcclxuICAgIGlmICh0aGlzLnkwID09PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMueTAgLT0xO1xyXG4gICAgdGhpcy5pc1JlbmRlciA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgbW92ZURvd24oKSB7XHJcbiAgICBpZiAodGhpcy55MCA9PT0gQ29uc3RhbnRzLmxldmVsU2l6ZSAtIENvbnN0YW50cy5jYW1lcmFTaXplKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMueTAgKz0xO1xyXG4gICAgdGhpcy5pc1JlbmRlciA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgbW92ZUxlZnQoKSB7XHJcbiAgICBpZiAodGhpcy54MCA9PT0gMCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLngwIC09MTtcclxuICAgIHRoaXMuaXNSZW5kZXIgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIG1vdmVSaWdodCgpIHtcclxuICAgIGlmICh0aGlzLngwID09PSBDb25zdGFudHMubGV2ZWxTaXplIC0gQ29uc3RhbnRzLmNhbWVyYVNpemUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy54MCArPTE7XHJcbiAgICB0aGlzLmlzUmVuZGVyID0gZmFsc2U7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJpbXBvcnQge0lDYW52YXNEYXRhfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQXNzZXRzXCI7XHJcbmltcG9ydCB7SUNhbWVyYX0gZnJvbSBcIi4uL2ludGVyZmFjZXMvSUNhbWVyYVwiO1xyXG5pbXBvcnQge0lUaWxlfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JVGlsZVwiO1xyXG5pbXBvcnQge0NvbnN0YW50c30gZnJvbSBcIi4uL2VudW1zL2NvbnN0YW50c1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlbmRlciB7XHJcblxyXG4gIHN0YXRpYyByZW5kZXJMYXllcihsYXllcjogSVRpbGVbXVtdLCBjYW52YXNEYXRhOiBJQ2FudmFzRGF0YSkge1xyXG4gICAgZm9yIChsZXQgaSBpbiBsYXllcikge1xyXG4gICAgICBmb3IgKGxldCBqIGluIGxheWVyW2ldKSB7XHJcbiAgICAgICAgY29uc3QgdGlsZSA9IGxheWVyW2ldW2pdO1xyXG4gICAgICAgIGlmICghdGlsZS50aWxlKSB7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGNhcnRYOiBudW1iZXIgPSBOdW1iZXIoaikgKiBDb25zdGFudHMudGlsZVdpZHRoIC8gMjtcclxuICAgICAgICBjb25zdCBjYXJ0WTogbnVtYmVyID0gTnVtYmVyKGkpICogQ29uc3RhbnRzLnRpbGVIZWlnaHQ7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzb1g6IG51bWJlciA9IGNhcnRYIC0gY2FydFkgKyBjYW52YXNEYXRhLndpZHRoIC8gMiAtIENvbnN0YW50cy50aWxlV2lkdGggLyAyO1xyXG4gICAgICAgIGNvbnN0IGlzb1k6IG51bWJlciA9IChjYXJ0WCArIGNhcnRZKSAvIDIgKyBjYW52YXNEYXRhLmhlaWdodCAvIDg7XHJcblxyXG5cclxuICAgICAgICBjYW52YXNEYXRhLmNvbnRleHQuZHJhd0ltYWdlKHRpbGUudGlsZSwgaXNvWCwgaXNvWSwgQ29uc3RhbnRzLnRpbGVXaWR0aCwgQ29uc3RhbnRzLnRpbGVIZWlnaHQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgcmVuZGVyKGNhbWVyYTogSUNhbWVyYSwgY2FudmFzRGF0YTogSUNhbnZhc0RhdGEpIHtcclxuICAgIGlmIChjYW1lcmEuaXNSZW5kZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNhbnZhc0RhdGEuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgY2FudmFzRGF0YS53aWR0aCwgY2FudmFzRGF0YS5oZWlnaHQpO1xyXG4gICAgY2FudmFzRGF0YS5jb250ZXh0LmZpbGxTdHlsZSA9ICcjMDAwJztcclxuICAgIGNhbnZhc0RhdGEuY29udGV4dC5maWxsUmVjdCgwLDAsIGNhbnZhc0RhdGEud2lkdGgsIGNhbnZhc0RhdGEuaGVpZ2h0KTtcclxuXHJcbiAgICBjb25zdCBsYXllcnMgPSBjYW1lcmEuZ2V0Q2FtZXJhO1xyXG5cclxuICAgIGZvciAoY29uc3QgbGF5ZXIgb2YgbGF5ZXJzKSB7XHJcbiAgICAgIHRoaXMucmVuZGVyTGF5ZXIobGF5ZXIsIGNhbnZhc0RhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIGNhbWVyYS5zZXRBc1JlbmRlcigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge1JlbmRlcn0gZnJvbSBcIi4vUmVuZGVyXCI7XHJcbmltcG9ydCB7SUNhbnZhc0RhdGF9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0lBc3NldHNcIjtcclxuaW1wb3J0IHtJQ2FtZXJhfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQ2FtZXJhXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgR2FtZUxvb3Age1xyXG5cclxuICBzdGF0aWMgaW5pdChjYW1lcmE6IElDYW1lcmEsIGNhbnZhc0RhdGE6IElDYW52YXNEYXRhKSB7XHJcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG4gICAgICBSZW5kZXIucmVuZGVyKGNhbWVyYSwgY2FudmFzRGF0YSk7XHJcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLmluaXQoY2FtZXJhLCBjYW52YXNEYXRhKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHtJVXNlckNvbnRyb2xsZXJ9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0lVc2VyQ29udHJvbGxlclwiO1xyXG5pbXBvcnQge0lDYW52YXNEYXRhfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQXNzZXRzXCI7XHJcbmltcG9ydCB7SUNhbWVyYX0gZnJvbSBcIi4uL2ludGVyZmFjZXMvSUNhbWVyYVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEtleWJvYXJkQ29udHJvbGxlciBpbXBsZW1lbnRzIElVc2VyQ29udHJvbGxlcntcclxuXHJcbiAgc2V0Q29udHJvbGxlclBvc2l0aW9uKGU6IEtleWJvYXJkRXZlbnQsIGNhbnZhczogSUNhbnZhc0RhdGEsIGNhbWVyYTogSUNhbWVyYSkge1xyXG4gICAgc3dpdGNoIChlLmtleSkge1xyXG4gICAgICBjYXNlICdBcnJvd0Rvd24nOiB7XHJcbiAgICAgICAgY2FtZXJhLm1vdmVEb3duKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnQXJyb3dVcCc6IHtcclxuICAgICAgICBjYW1lcmEubW92ZVVwKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnQXJyb3dMZWZ0Jzoge1xyXG4gICAgICAgIGNhbWVyYS5tb3ZlTGVmdCgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOiB7XHJcbiAgICAgICAgY2FtZXJhLm1vdmVSaWdodCgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7SUxheWVyfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JTGF5ZXJcIjtcclxuaW1wb3J0IHtJVGlsZX0gZnJvbSBcIi4uL2ludGVyZmFjZXMvSVRpbGVcIjtcclxuaW1wb3J0IHtJTGF5ZXJEYXRhfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JTGF5ZXJEYXRhXCI7XHJcbmltcG9ydCB7Q29uc3RhbnRzfSBmcm9tIFwiLi4vZW51bXMvY29uc3RhbnRzXCI7XHJcbmltcG9ydCB7SUFzc2V0LCBJQXNzZXRzfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQXNzZXRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTGF5ZXIgaW1wbGVtZW50cyBJTGF5ZXIge1xyXG4gIGxheWVyTWF0cml4OiBJVGlsZVtdW107XHJcbiAgbGF5ZXJEYXRhOiBJTGF5ZXJEYXRhXHJcblxyXG4gIGNvbnN0cnVjdG9yKGxheWVyRGF0YTogYW55KSB7XHJcbiAgICB0aGlzLmxheWVyRGF0YSA9IGxheWVyRGF0YTtcclxuICAgIHRoaXMubGF5ZXJNYXRyaXggPSBbXTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGlsZVJvdyhmaXJzdEluZGV4OiBudW1iZXIsIGxhc3RJbmRleDogbnVtYmVyKSB7XHJcbiAgICBjb25zdCByb3cgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSBmaXJzdEluZGV4OyBpIDwgbGFzdEluZGV4OyBpKyspIHtcclxuICAgICAgcm93LnB1c2godGhpcy5sYXllckRhdGEuZGF0YVtpXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcm93O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZVRpbGUoYXNzZXRzOiBJQXNzZXRzLCBpZDogbnVtYmVyKSB7XHJcbiAgICBsZXQgdGlsZUlkID0gaWQ7XHJcbiAgICBjb25zdCBzSGVpZ2h0OiBudW1iZXIgPSBDb25zdGFudHMudGlsZUhlaWdodDtcclxuICAgIGNvbnN0IHNXaWR0aDogbnVtYmVyID0gQ29uc3RhbnRzLnRpbGVXaWR0aDtcclxuXHJcbiAgICBjb25zdCBoZWlnaHQ6IG51bWJlciA9IENvbnN0YW50cy50aWxlSGVpZ2h0O1xyXG4gICAgY29uc3Qgd2lkdGg6IG51bWJlciA9IENvbnN0YW50cy50aWxlV2lkdGg7XHJcblxyXG4gICAgbGV0IHNYID0gQ29uc3RhbnRzLnRpbGVXaWR0aCAqICh0aWxlSWQgLSAxKTtcclxuICAgIGxldCBzWSA9IDA7XHJcblxyXG4gICAgY29uc3Qgc3ByaXRlOiBJQXNzZXQgPSBhc3NldHMuc3ByaXRlcy5maW5kKHMgPT4gdGlsZUlkID49IHMuZmlyc3RUaWxlICYmIHRpbGVJZCA8PSBzLmxhc3RUaWxlKTtcclxuXHJcbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgU3RyaW5nKHdpZHRoKSk7XHJcbiAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBTdHJpbmcoaGVpZ2h0KSk7XHJcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcbiAgICBpZiAoIXNwcml0ZSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGlmIChzcHJpdGUuZmlyc3RUaWxlICE9IDEpIHtcclxuICAgICAgdGlsZUlkID0gdGlsZUlkIC0gc3ByaXRlLmZpcnN0VGlsZTtcclxuICAgIH1cclxuXHJcbiAgICAhdGlsZUlkICYmICh0aWxlSWQgPSAxKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyh0aWxlSWQpXHJcblxyXG4gICAgY29uc3Qge2Fzc2V0fSA9IHNwcml0ZTtcclxuXHJcbiAgICBjb25zdCB7bmF0dXJhbFdpZHRoLCBuYXR1cmFsSGVpZ2h0fSA9IGFzc2V0O1xyXG5cclxuICAgIGNvbnN0IG1heEluUm93ID0gbmF0dXJhbFdpZHRoIC8gQ29uc3RhbnRzLnRpbGVXaWR0aDtcclxuICAgIGNvbnN0IG1heFJvdyA9IG5hdHVyYWxIZWlnaHQgLyBDb25zdGFudHMudGlsZUhlaWdodDtcclxuXHJcbiAgICBsZXQgY3VycmVudFRpbGVJZFJvdyA9IDA7XHJcblxyXG4gICAgaWYgKHRpbGVJZCA+IG1heEluUm93KSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF4Um93OyBpKyspIHtcclxuICAgICAgICBpZiAodGlsZUlkID4gaSAqIG1heEluUm93ICYmIHRpbGVJZCA8PSAoaSAqIG1heEluUm93ICsgbWF4SW5Sb3cpKSB7XHJcbiAgICAgICAgICBjdXJyZW50VGlsZUlkUm93ID0gaTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNYID0gKHRpbGVJZCAtIG1heEluUm93ICogY3VycmVudFRpbGVJZFJvdykgLSAxO1xyXG4gICAgICBzWSA9IENvbnN0YW50cy50aWxlSGVpZ2h0ICogY3VycmVudFRpbGVJZFJvdztcclxuICAgIH1cclxuXHJcbiAgICBjdHguZHJhd0ltYWdlKGFzc2V0LCBzWCwgc1ksIHNXaWR0aCwgc0hlaWdodCwgMCwgMCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICByZXR1cm4gY2FudmFzO1xyXG5cclxuICB9XHJcblxyXG4gIGZpbGxMYXllck1hdHJpeChhc3NldHM6IElBc3NldHMpIHtcclxuICAgIGNvbnN0IHF1YW50aXR5Um93cyA9IHRoaXMubGF5ZXJEYXRhLmRhdGEubGVuZ3RoIC8gQ29uc3RhbnRzLmxldmVsU2l6ZTtcclxuICAgIGNvbnN0IGxheWVyTWF0cml4VGlsZUlkOiBhbnkgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcXVhbnRpdHlSb3dzOyBpKyspIHtcclxuICAgICAgbGF5ZXJNYXRyaXhUaWxlSWQucHVzaCh0aGlzLmdldFRpbGVSb3coKGkgKiBDb25zdGFudHMubGV2ZWxTaXplKSwgKChpICsgMSkgKiAzMikpKVxyXG4gICAgfTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxheWVyTWF0cml4VGlsZUlkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGF5ZXJNYXRyaXhUaWxlSWRbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICBjb25zdCB0aWxlOiBJVGlsZSA9IHtcclxuICAgICAgICAgIHRpbGU6IHRoaXMuZ2VuZXJhdGVUaWxlKGFzc2V0cywgbGF5ZXJNYXRyaXhUaWxlSWRbaV1bal0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxheWVyTWF0cml4VGlsZUlkW2ldW2pdID0gdGlsZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMubGF5ZXJNYXRyaXggPSBsYXllck1hdHJpeFRpbGVJZDtcclxuICB9XHJcblxyXG59XHJcbiIsImltcG9ydCB7SUFzc2V0fSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQXNzZXRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTG9hZGVyIHtcclxuICBzdGF0aWMgYXN5bmMgbG9hZChhc3NldDogSUFzc2V0KSB7XHJcbiAgICBhc3NldC5hc3NldC5zcmMgPSBhc3NldC5zcmM7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4gKHJlc29sdmUgPT4ge1xyXG4gICAgICBpZiAoIWFzc2V0LnNyYykge1xyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfVxyXG4gICAgICBhc3NldC5hc3NldC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfSlcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge0xvYWRlcn0gZnJvbSBcIi4vTG9hZGVyXCI7XHJcbmltcG9ydCB7SUFzc2V0fSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JQXNzZXRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSW1hZ2VMb2FkZXIgZXh0ZW5kcyBMb2FkZXIge1xyXG5cclxuICBzdGF0aWMgYXN5bmMgbG9hZEFsbChpbWFnZXM6IElBc3NldFtdKSB7XHJcbiAgICBjb25zdCBhbGxMb2FkZXJzID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGltYWdlIG9mIGltYWdlcykge1xyXG4gICAgICBhbGxMb2FkZXJzLnB1c2godGhpcy5sb2FkKGltYWdlKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKGFsbExvYWRlcnMpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge0lBc3NldCwgSUFzc2V0RGF0YSwgSUFzc2V0c30gZnJvbSBcIi4uL2ludGVyZmFjZXMvSUFzc2V0c1wiO1xyXG5pbXBvcnQge0ltYWdlTG9hZGVyfSBmcm9tIFwiLi4vTG9hZGVycy9JbWFnZUxvYWRlclwiO1xyXG5pbXBvcnQge0NvbnN0YW50c30gZnJvbSBcIi4uL2VudW1zL2NvbnN0YW50c1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEFzc2V0cyBpbXBsZW1lbnRzIElBc3NldHMge1xyXG4gIHNwcml0ZXM6IElBc3NldFtdO1xyXG4gIGFzc2V0c0RhdGE6IElBc3NldERhdGFbXTtcclxuXHJcbiAgY29uc3RydWN0b3IoYXNzZXRzRGF0YTogSUFzc2V0RGF0YVtdKSB7XHJcbiAgICB0aGlzLmFzc2V0c0RhdGEgPSBhc3NldHNEYXRhO1xyXG4gICAgdGhpcy5zcHJpdGVzID0gW107XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkQXNzZXRzKCkge1xyXG4gICAgdGhpcy5hc3NldHNEYXRhLm1hcChhID0+IHtcclxuICAgICAgY29uc3QgYXNzZXQ6IElBc3NldCA9ICB7XHJcbiAgICAgICAgaWQ6IGEuc291cmNlLnNwbGl0KCcuJylbMF0sXHJcbiAgICAgICAgZmlyc3RUaWxlOiBhLmZpcnN0Z2lkLFxyXG4gICAgICAgIGxhc3RUaWxlOiAwLFxyXG4gICAgICAgIGFzc2V0OiBuZXcgSW1hZ2UoKSxcclxuICAgICAgICBzcmM6IGAuL3B1YmxpYy9hc3NldHMvJHsgYS5zb3VyY2Uuc3BsaXQoJy4nKVswXSB9LnBuZ2BcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnNwcml0ZXMucHVzaChhc3NldCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLnNwcml0ZXMubWFwKChzLCBpKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLnNwcml0ZXNbaSArMV0pIHtcclxuICAgICAgICBzLmxhc3RUaWxlID0gdGhpcy5zcHJpdGVzW2kgKyAxXS5maXJzdFRpbGUgLSAxO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHMubGFzdFRpbGUgPSBDb25zdGFudHMubWF4VGlsZUlEO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGF3YWl0IEltYWdlTG9hZGVyLmxvYWRBbGwodGhpcy5zcHJpdGVzKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IEdhbWUgZnJvbSBcIi4vZ2VuZXJhbC9HYW1lXCI7XHJcbmltcG9ydCB7Q2FtZXJhfSBmcm9tIFwiLi9nZW5lcmFsL0NhbWVyYVwiO1xyXG5pbXBvcnQge0dhbWVMb29wfSBmcm9tIFwiLi9nZW5lcmFsL0dhbWVMb29wXCI7XHJcbmltcG9ydCB7SW1hZ2VMb2FkZXJ9IGZyb20gXCIuL0xvYWRlcnMvSW1hZ2VMb2FkZXJcIjtcclxuaW1wb3J0IHtJTGF5ZXJ9IGZyb20gXCIuL2ludGVyZmFjZXMvSUxheWVyXCI7XHJcbmltcG9ydCB7S2V5Ym9hcmRDb250cm9sbGVyfSBmcm9tIFwiLi9Db250cm9sbGVycy9LZXlib2FyZENvbnRyb2xsZXJcIjtcclxuaW1wb3J0IHtMYXllcn0gZnJvbSBcIi4vZ2VuZXJhbC9MYXllclwiO1xyXG5pbXBvcnQge0Fzc2V0c30gZnJvbSBcIi4vZ2VuZXJhbC9Bc3NldHNcIjtcclxuY29uc3QgZ2FtZSA9IG5ldyBHYW1lKCdjYW52YXMnLDc2OCwgMTAyNCk7XHJcblxyXG5jb25zdCBsYXllcnNEYXRhID0gcmVxdWlyZSgnLi4vYXNzZXRzL2RuZC5qc29uJyk7XHJcblxyXG5jb25zdCBzdGFydFVwID0gYXN5bmMgKCkgPT4ge1xyXG4gIGdhbWUuaW5pdCgpO1xyXG4gIGNvbnN0IGRhdGEgPSBnYW1lLmNhbnZhc0RhdGE7XHJcblxyXG4gIGNvbnN0IGFzc2V0cyA9IG5ldyBBc3NldHMobGF5ZXJzRGF0YS50aWxlc2V0cyk7XHJcblxyXG4gIGF3YWl0IGFzc2V0cy5sb2FkQXNzZXRzKCk7XHJcblxyXG4gIGNvbnN0IGxheWVyczogSUxheWVyW10gPSBbXTtcclxuXHJcbiAgZm9yIChjb25zdCBsYXllckRhdGEgb2YgbGF5ZXJzRGF0YS5sYXllcnMpIHtcclxuICAgIGNvbnN0IGxheWVyID0gbmV3IExheWVyKGxheWVyRGF0YSk7XHJcbiAgICBsYXllci5maWxsTGF5ZXJNYXRyaXgoYXNzZXRzKTtcclxuICAgIGxheWVycy5wdXNoKGxheWVyKTtcclxuICB9XHJcblxyXG5cclxuICBjb25zdCBjYW1lcmEgPSBuZXcgQ2FtZXJhKGRhdGEsIGxheWVycyk7XHJcbiAgR2FtZUxvb3AuaW5pdChjYW1lcmEsIGRhdGEpO1xyXG5cclxuICBjb25zdCBjb250cm9sbGVyID0gbmV3IEtleWJvYXJkQ29udHJvbGxlcigpO1xyXG5cclxuICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XHJcblxyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZSA9PiBjb250cm9sbGVyLnNldENvbnRyb2xsZXJQb3NpdGlvbihlLCBkYXRhLCBjYW1lcmEpKVxyXG5cclxufVxyXG5cclxuc3RhcnRVcCgpO1xyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==